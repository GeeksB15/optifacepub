import{_ as q,r as b,o as d,j as c,p as r,a as e,aT as _,w as t,ab as w,ad as Q,Z as C,a6 as u,h as I,d as R,aU as V,a3 as f,e as k,D as g,f as p,ac as A,k as D,t as v,ae as S,a8 as z,aV as m,l as E,aa as $}from"./index.8f4630be.js";import{Q as L}from"./QTooltip.4c19377f.js";import{Q as h}from"./QForm.352236cf.js";const y={dialog:{mostrar:!1,contagemRegressiva:null,codigoAcesso:""}},T={data(){return{tela:0,idiomaSelecionado:{},usuario:"",dialog:$utils.clonar(y.dialog),validacao:{required:[a=>!!a||"Preenchimento obrigat\xF3rio."]}}},methods:{limparDialog(){this.dialog=$utils.clonar(y.dialog),clearInterval(this.contagemRegressivaInterval)},contagemRegressiva(a){if(clearInterval(this.contagemRegressivaInterval),a<0){this.dialog.contagemRegressiva="00:00";return}this.contagemRegressivaInterval=setInterval(()=>{const o=Math.floor(a/60),n=a%60;this.dialog.contagemRegressiva=`${o.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`,a===0?clearInterval(this.contagemRegressivaInterval):a--},1e3)},idioma(a){this.idiomaSelecionado=a},async gerarCodigoAcesso(){try{$q.loading.show();const a=await $utils.api({funcao:"0DC8D9F7-45EB-4917-B805-C8E900EEEE2A",usuario:this.usuario});if(a.erro)$q.notify({message:a.erro,type:"negative"});else{const o=new Date,n=new Date(a.exp);this.contagemRegressiva(Math.floor((n-o)/1e3)),this.dialog.codigoAcesso="",this.dialog.mostrar=!0}}catch(a){$q.notify({message:a.message,type:"negative"})}finally{$q.loading.hide()}},async login(){try{$q.loading.show();const a=await $utils.sessao.load({usuario:this.usuario,codigoAcesso:this.dialog.codigoAcesso});a.erro?$q.notify({message:a.erro,type:"negative"}):$router.push(`/?ts=${new Date().getTime()}`)}catch(a){$q.notify({message:a.message,type:"negative"})}finally{$q.loading.hide()}},cadastrar(){this.$router.replace("/cadastrar")},async resize(){const a=$utils.tela("LoginHeader").height,o=$utils.tela("LoginFooter").height;this.tela=a+o}}},B={id:"Login",class:"bg-login"},F={class:"q-mx-auto"},H={class:"text-center text-weight-light text-overline"},M={key:0,class:"q-mt-sm text-center text-caption"},N={key:0,class:"text-orange-3"},U={key:1,class:"text-negative"},P={class:"text-center text-caption"};function j(a,o,n,O,s,l){const x=b("ToolbarMain");return d(),c("div",null,[r("div",B,[e(_,{onResize:o[0]||(o[0]=i=>l.resize())}),e(w,{id:"LoginHeader",class:"q-py-lg q-px-md"},{default:t(()=>[e(x,{onIdioma:l.idioma},null,8,["onIdioma"])]),_:1}),e(A,null,{default:t(()=>[e(Q,{class:"g-container flex items-center justify-center text-white",style:C(`min-height:calc(100vh - ${s.tela}px);`)},{default:t(()=>[e(h,{onSubmit:u(l.gerarCodigoAcesso,["prevent"]),novalidate:"",autocorrect:"off",spellcheck:"false",autocapitalize:"off",autocomplete:"off",class:"full-width q-pa-md",style:{"max-width":"460px"}},{default:t(()=>[e(I,{dense:"",dark:""},{default:t(()=>[e(R,null,{default:t(()=>[e(V,{round:"",color:"dark",size:"100px",class:"q-mb-xl q-mx-auto"},{default:t(()=>o[5]||(o[5]=[r("img",{src:"https://cdn.quasar.dev/logo-v2/svg/logo.svg"},null,-1)])),_:1}),e(f,{modelValue:s.usuario,"onUpdate:modelValue":o[1]||(o[1]=i=>s.usuario=i),rules:s.validacao.required,"lazy-rules":"",filled:"",label:"Usu\xE1rio",class:"q-my-md"},null,8,["modelValue","rules"]),e(k,{class:"q-my-md"},{default:t(()=>[e(g,{type:"submit",icon:"arrow_forward",color:"primary",round:"",unelevated:"",class:"float-right"},{default:t(()=>[e(L,{anchor:"bottom middle",self:"center middle"},{default:t(()=>o[6]||(o[6]=[p(" Avan\xE7ar ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["style"])]),_:1}),e(S,{id:"LoginFooter",class:"bg-transparent q-py-lg q-px-md"},{default:t(()=>[e(D,null,{default:t(()=>[r("div",F,[e(g,{type:"button",onClick:o[2]||(o[2]=i=>l.cadastrar()),label:"Inscrever-se",color:"primary",class:"q-mb-xl"}),r("div",H,v(a.$db.app.versao.value),1)])]),_:1})]),_:1})]),e($,{modelValue:s.dialog.mostrar,"onUpdate:modelValue":o[4]||(o[4]=i=>s.dialog.mostrar=i),onHide:l.limparDialog},{default:t(()=>[e(z,{class:"q-pa-md",style:{"max-width":"400px",width:"100%"}},{default:t(()=>[e(m,null,{default:t(()=>o[7]||(o[7]=[r("div",{class:"text-h6"}," Enviamos por e-mail/whatsapp um c\xF3digo de acesso ",-1)])),_:1}),e(h,{onSubmit:u(l.login,["prevent"]),novalidate:"",autocorrect:"off",spellcheck:"false"},{default:t(()=>[e(m,null,{default:t(()=>[e(f,{modelValue:s.dialog.codigoAcesso,"onUpdate:modelValue":o[3]||(o[3]=i=>s.dialog.codigoAcesso=i),rules:s.validacao.required,label:"C\xF3digo de acesso",filled:"",dense:""},null,8,["modelValue","rules"])]),_:1}),e(m,null,{default:t(()=>[e(g,{type:"submit",label:"Fazer login",color:"primary",class:"full-width"}),s.dialog.contagemRegressiva?(d(),c("div",M,[s.dialog.contagemRegressiva!=="00:00"?(d(),c("span",N," C\xF3digo expira em "+v(s.dialog.contagemRegressiva),1)):(d(),c("span",U," O c\xF3digo expirou, solicite um novo. "))])):E("",!0)]),_:1})]),_:1},8,["onSubmit"]),e(m,{class:"q-pt-none q-mt-sm"},{default:t(()=>[r("div",P,[o[8]||(o[8]=p(" N\xE3o recebeu o c\xF3digo? ")),e(g,{flat:"",label:"Reenviar c\xF3digo",onClick:l.gerarCodigoAcesso,class:"q-ml-xs",color:"primary"},null,8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","onHide"])])}var K=q(T,[["render",j]]);export{K as default};
