import{_ as x,r as q,o as n,j as d,p as g,a as e,aT as b,w as t,ab as _,ad as w,Z as Q,a6 as u,h as C,d as I,aU as R,a3 as f,e as V,B as c,f as p,ac as k,k as A,ae as S,a8 as z,aV as m,t as D,U as E,aa as B}from"./index.e05c9ea9.js";import{Q as L}from"./QTooltip.497ea527.js";import{Q as v}from"./QForm.0b96a0d4.js";const h={dialog:{mostrar:!1,contagemRegressiva:null,codigoAcesso:""}},T={data(){return{tela:0,idiomaSelecionado:{},usuario:"",dialog:$utils.clonar(h.dialog),validacao:{required:[o=>!!o||"Preenchimento obrigat\xF3rio."]}}},methods:{limparDialog(){this.dialog=$utils.clonar(h.dialog),clearInterval(this.contagemRegressivaInterval)},contagemRegressiva(o){if(clearInterval(this.contagemRegressivaInterval),o<0){this.dialog.contagemRegressiva="00:00";return}this.contagemRegressivaInterval=setInterval(()=>{const a=Math.floor(o/60),r=o%60;this.dialog.contagemRegressiva=`${a.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`,o===0?clearInterval(this.contagemRegressivaInterval):o--},1e3)},idioma(o){this.idiomaSelecionado=o},async gerarCodigoAcesso(){try{$q.loading.show();const o=await $utils.api({funcao:"0DC8D9F7-45EB-4917-B805-C8E900EEEE2A",usuario:this.usuario});if(o.erro)$q.notify({message:o.erro,type:"negative"});else{const a=new Date,r=new Date(o.exp);this.contagemRegressiva(Math.floor((r-a)/1e3)),this.dialog.mostrar=!0}}catch(o){$q.notify({message:o.message,type:"negative"})}finally{$q.loading.hide()}},async login(){try{$q.loading.show();const o=await $utils.sessao.load({usuario:this.usuario,codigoAcesso:this.dialog.codigoAcesso});o.erro?$q.notify({message:o.erro,type:"negative"}):$router.push(`/?ts=${new Date().getTime()}`)}catch(o){$q.notify({message:o.message,type:"negative"})}finally{$q.loading.hide()}},cadastrar(){this.$router.replace("/cadastrar")},async resize(){const o=$utils.tela("LoginHeader").height,a=$utils.tela("LoginFooter").height;this.tela=o+a}}},$={id:"Login",class:"bg-login"},F={key:0,class:"q-mt-sm text-center text-caption"},U={key:0,class:"text-orange-3"},H={key:1,class:"text-negative"},M={class:"text-center text-caption"};function N(o,a,r,P,s,l){const y=q("ToolbarMain");return n(),d("div",null,[g("div",$,[e(b,{onResize:a[0]||(a[0]=i=>l.resize())}),e(_,{id:"LoginHeader",class:"q-py-lg q-px-md"},{default:t(()=>[e(y,{onIdioma:l.idioma},null,8,["onIdioma"])]),_:1}),e(k,null,{default:t(()=>[e(w,{class:"g-container flex items-center justify-center text-white",style:Q(`min-height:calc(100vh - ${s.tela}px);`)},{default:t(()=>[e(v,{onSubmit:u(l.gerarCodigoAcesso,["prevent"]),novalidate:"",autocorrect:"off",spellcheck:"false",autocapitalize:"off",autocomplete:"off",class:"full-width q-pa-md",style:{"max-width":"460px"}},{default:t(()=>[e(C,{dense:"",dark:""},{default:t(()=>[e(I,null,{default:t(()=>[e(R,{round:"",color:"dark",size:"100px",class:"q-mb-xl q-mx-auto"},{default:t(()=>a[5]||(a[5]=[g("img",{src:"https://cdn.quasar.dev/logo-v2/svg/logo.svg"},null,-1)])),_:1}),e(f,{modelValue:s.usuario,"onUpdate:modelValue":a[1]||(a[1]=i=>s.usuario=i),rules:s.validacao.required,"lazy-rules":"",filled:"",label:"Usu\xE1rio",class:"q-my-md"},null,8,["modelValue","rules"]),e(V,{class:"q-my-md"},{default:t(()=>[e(c,{type:"submit",icon:"arrow_forward",color:"primary",round:"",unelevated:"",class:"float-right"},{default:t(()=>[e(L,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[6]||(a[6]=[p(" Avan\xE7ar ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["style"])]),_:1}),e(S,{id:"LoginFooter",class:"bg-transparent q-py-lg q-px-md"},{default:t(()=>[e(A,null,{default:t(()=>[e(c,{type:"button",onClick:a[2]||(a[2]=i=>l.cadastrar()),label:"Inscrever-se",color:"primary",class:"q-mx-auto"})]),_:1})]),_:1})]),e(B,{modelValue:s.dialog.mostrar,"onUpdate:modelValue":a[4]||(a[4]=i=>s.dialog.mostrar=i),onHide:l.limparDialog},{default:t(()=>[e(z,{class:"q-pa-md",style:{"max-width":"400px",width:"100%"}},{default:t(()=>[e(m,null,{default:t(()=>a[7]||(a[7]=[g("div",{class:"text-h6"}," Enviamos por e-mail/whatsapp um c\xF3digo de acesso ",-1)])),_:1}),e(v,{onSubmit:u(l.login,["prevent"]),novalidate:"",autocorrect:"off",spellcheck:"false"},{default:t(()=>[e(m,null,{default:t(()=>[e(f,{modelValue:s.dialog.codigoAcesso,"onUpdate:modelValue":a[3]||(a[3]=i=>s.dialog.codigoAcesso=i),rules:s.validacao.required,label:"C\xF3digo de acesso",filled:"",dense:""},null,8,["modelValue","rules"])]),_:1}),e(m,null,{default:t(()=>[e(c,{type:"submit",label:"Fazer login",color:"primary",class:"full-width"}),s.dialog.contagemRegressiva?(n(),d("div",F,[s.dialog.contagemRegressiva!=="00:00"?(n(),d("span",U," C\xF3digo expira em "+D(s.dialog.contagemRegressiva),1)):(n(),d("span",H," O c\xF3digo expirou, solicite um novo. "))])):E("",!0)]),_:1})]),_:1},8,["onSubmit"]),e(m,{class:"q-pt-none q-mt-sm"},{default:t(()=>[g("div",M,[a[8]||(a[8]=p(" N\xE3o recebeu o c\xF3digo? ")),e(c,{flat:"",label:"Reenviar c\xF3digo",onClick:l.gerarCodigoAcesso,class:"q-ml-xs",color:"primary"},null,8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","onHide"])])}var G=x(T,[["render",N]]);export{G as default};
