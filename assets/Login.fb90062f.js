import{_ as b,r as _,o as d,j as g,p as n,a,aT as w,w as t,ab as Q,ad as C,Z as I,a6 as f,h as R,d as V,aU as k,a3 as v,e as A,D as c,f as p,ac as D,k as S,t as h,ae as z,a8 as $,aV as u,l as E,aa as L}from"./index.c9595cd1.js";import{Q as T}from"./QTooltip.030532bc.js";import{Q as y}from"./QForm.6d877b72.js";const x={dialog:{mostrar:!1,contagemRegressiva:null,codigoAcesso:""}},B={data(){return{tela:0,idiomaSelecionado:{},usuario:"",dialog:$utils.clonar(x.dialog),validacao:{required:[o=>!!o||"Preenchimento obrigat\xF3rio."]}}},methods:{limparDialog(){this.dialog=$utils.clonar(x.dialog),clearInterval(this.contagemRegressivaInterval)},contagemRegressiva(o){if(clearInterval(this.contagemRegressivaInterval),o<0){this.dialog.contagemRegressiva="00:00";return}this.contagemRegressivaInterval=setInterval(()=>{const e=Math.floor(o/60),l=o%60;this.dialog.contagemRegressiva=`${e.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`,o===0?clearInterval(this.contagemRegressivaInterval):o--},1e3)},idioma(o){this.idiomaSelecionado=o},async gerarCodigoAcesso(o){var e;try{$q.loading.show();const l=await $utils.api({funcao:"0DC8D9F7-45EB-4917-B805-C8E900EEEE2A",usuario:this.usuario,reenviar:(e=o==null?void 0:o.reenviar)!=null?e:!1});if(l.erro)$q.notify({message:l.erro,type:"negative"});else{const m=new Date,s=new Date(l.exp);this.contagemRegressiva(Math.floor((s-m)/1e3)),this.dialog.codigoAcesso="",this.dialog.mostrar=!0}}catch(l){$q.notify({message:l.message,type:"negative"})}finally{$q.loading.hide()}},async login(){try{$q.loading.show();const o=await $utils.sessao.load({usuario:this.usuario,codigoAcesso:this.dialog.codigoAcesso});o.erro?$q.notify({message:o.erro,type:"negative"}):$router.push(`/?ts=${new Date().getTime()}`)}catch(o){$q.notify({message:o.message,type:"negative"})}finally{$q.loading.hide()}},cadastrar(){this.$router.replace("/cadastrar")},async resize(){const o=$utils.tela("LoginHeader").height,e=$utils.tela("LoginFooter").height;this.tela=o+e}}},F={id:"Login",class:"bg-login"},H={class:"q-mx-auto"},M={class:"text-center text-weight-light text-overline"},N={key:0,class:"q-mt-sm text-center text-caption"},U={key:0,class:"text-orange-3"},P={key:1,class:"text-negative"},j={class:"text-center text-caption"};function O(o,e,l,m,s,r){const q=_("ToolbarMain");return d(),g("div",null,[n("div",F,[a(w,{onResize:e[0]||(e[0]=i=>r.resize())}),a(Q,{id:"LoginHeader",class:"q-py-lg q-px-md"},{default:t(()=>[a(q,{onIdioma:r.idioma},null,8,["onIdioma"])]),_:1}),a(D,null,{default:t(()=>[a(C,{class:"g-container flex items-center justify-center text-white",style:I(`min-height:calc(100vh - ${s.tela}px);`)},{default:t(()=>[a(y,{onSubmit:f(r.gerarCodigoAcesso,["prevent"]),novalidate:"",autocorrect:"off",spellcheck:"false",autocapitalize:"off",autocomplete:"off",class:"full-width q-pa-md",style:{"max-width":"460px"}},{default:t(()=>[a(R,{dense:"",dark:""},{default:t(()=>[a(V,null,{default:t(()=>[a(k,{round:"",color:"dark",size:"100px",class:"q-mb-xl q-mx-auto"},{default:t(()=>e[6]||(e[6]=[n("img",{src:"https://cdn.quasar.dev/logo-v2/svg/logo.svg"},null,-1)])),_:1}),a(v,{modelValue:s.usuario,"onUpdate:modelValue":e[1]||(e[1]=i=>s.usuario=i),rules:s.validacao.required,"lazy-rules":"",filled:"",label:"Usu\xE1rio",class:"q-my-md"},null,8,["modelValue","rules"]),a(A,{class:"q-my-md"},{default:t(()=>[a(c,{type:"submit",icon:"arrow_forward",color:"primary",round:"",unelevated:"",class:"float-right"},{default:t(()=>[a(T,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[7]||(e[7]=[p(" Avan\xE7ar ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["style"])]),_:1}),a(z,{id:"LoginFooter",class:"bg-transparent q-py-lg q-px-md"},{default:t(()=>[a(S,null,{default:t(()=>[n("div",H,[a(c,{type:"button",onClick:e[2]||(e[2]=i=>r.cadastrar()),label:"Inscrever-se",color:"primary",class:"q-mb-xl"}),n("div",M,h(o.$db.app.versao.value),1)])]),_:1})]),_:1})]),a(L,{modelValue:s.dialog.mostrar,"onUpdate:modelValue":e[5]||(e[5]=i=>s.dialog.mostrar=i),onHide:r.limparDialog},{default:t(()=>[a($,{class:"q-pa-md",style:{"max-width":"400px",width:"100%"}},{default:t(()=>[a(u,null,{default:t(()=>e[8]||(e[8]=[n("div",{class:"text-h6"}," Enviamos por e-mail/whatsapp um c\xF3digo de acesso ",-1)])),_:1}),a(y,{onSubmit:f(r.login,["prevent"]),novalidate:"",autocorrect:"off",spellcheck:"false"},{default:t(()=>[a(u,null,{default:t(()=>[a(v,{modelValue:s.dialog.codigoAcesso,"onUpdate:modelValue":e[3]||(e[3]=i=>s.dialog.codigoAcesso=i),rules:s.validacao.required,label:"C\xF3digo de acesso",filled:"",dense:""},null,8,["modelValue","rules"])]),_:1}),a(u,null,{default:t(()=>[a(c,{type:"submit",label:"Fazer login",color:"primary",class:"full-width"}),s.dialog.contagemRegressiva?(d(),g("div",N,[s.dialog.contagemRegressiva!=="00:00"?(d(),g("span",U," C\xF3digo expira em "+h(s.dialog.contagemRegressiva),1)):(d(),g("span",P," O c\xF3digo expirou, solicite um novo. "))])):E("",!0)]),_:1})]),_:1},8,["onSubmit"]),a(u,{class:"q-pt-none q-mt-sm"},{default:t(()=>[n("div",j,[e[9]||(e[9]=p(" N\xE3o recebeu o c\xF3digo? ")),a(c,{flat:"",label:"Reenviar c\xF3digo",onClick:e[4]||(e[4]=i=>r.gerarCodigoAcesso({reenviar:!0})),class:"q-ml-xs",color:"primary"})])]),_:1})]),_:1})]),_:1},8,["modelValue","onHide"])])}var K=b(B,[["render",O]]);export{K as default};
